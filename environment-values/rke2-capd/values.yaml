debug: true

git_repo_templates:
  capi-bootstrap:
    spec:
      ref:
        commit: $CURRENT_COMMIT

components:
  cluster:
    kustomization_spec:
      path: ./kustomize-components/management-cluster/rke2-capd/base
  rancher:
    enabled: management-only
  k8s-gateway:
    enabled: management-only
    depends_on:
    - name: metallb
  rancher-import:
    enabled: management-only
  metallb:
    enabled: management-only
    repo: capi-bootstrap
    depends_on:
    - name: cert-manager      
    spec:
      path: ./kustomize-components/metallb
      wait: true    

  #FIXME: figure out why pivot works locally and not in gitlab ci... (whereas pivot work with kubadm-capd in ci)
  pivot:
    enabled: false

cluster:
  flavor:
    infra_provider: capd
    bootstrap_provider: cabpr

capd:
  docker_host: $DOCKER_HOST

proxies:
  http_proxy: $http_proxy
  https_proxy: $https_proxy
  no_proxy: $no_proxy
