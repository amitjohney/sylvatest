{{- $envAll := set . "Values" (include "interpret-values-gotpl" . | fromJson) -}}
{{- if (or (tuple $envAll "cluster" | include "is-component-enabled") (tuple $envAll "capd" | include "is-component-enabled") (tuple $envAll "k8s-gateway" | include "is-component-enabled")) -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-vars
  labels:
{{ include "telco-cloud-init.labels" $envAll | indent 4 }}
data:
  CLUSTER_NAME: {{ .Values.cluster.name }}
  MACHINE_IMAGE: {{ .Values.cluster.image }}
{{ if eq .Values.cluster.flavor.infra_provider "capo" }}
  SSH_KEY_NAME: {{ .Values.cluster.capo.ssh_key_name }}
  CAPO_NETWORK_ID: {{ .Values.cluster.capo.network_id }}
  KUBE_VIP_IP: {{ .Values.cluster.capo.kube_vip_ip }}
{{ end }}
{{ if eq .Values.cluster.flavor.infra_provider "capd" }}
  DOCKER_HOST: {{ .Values.capd.docker_host }}
{{ end }}
{{ if eq .Values.cluster.flavor.infra_provider "capv" }}
  VS_DC_NAME: {{ .Values.cluster.capv.dataCenter }}
  VS_NETWORK: {{ .Values.cluster.capv.network }}
  VS_USERNAME: {{ .Values.cluster.capv.username }}
  VS_PASSWORD: {{ .Values.cluster.capv.password }}
  VS_SERVER: {{ .Values.cluster.capv.server }}
  VS_TLS_THUMBPRINT: {{ .Values.cluster.capv.tlsThumbprint }}
{{ end }}
{{ end }}
