# the management cluster has all units defined in values.yaml
# (except the ones explicitly set 'enabled: false' in values.yaml
#  and not explicitely set 'enabled: false' here)
units_enabled_default: true


units:

  capd:
    enabled: '{{ .Values.cluster.capi_providers.infra_provider | eq "capd" }}'

  capo:
    enabled: '{{ .Values.cluster.capi_providers.infra_provider | eq "capo" }}'

  capm3:
    enabled: '{{ .Values.cluster.capi_providers.infra_provider | eq "capm3" }}'

  metal3:
    enabled: '{{ (and (tuple . "capm3" | include "unit-enabled") (.Values.metal3.provider | eq "sylva")) }}'

  metal3-suse:
    enabled: '{{ (and (tuple . "capm3" | include "unit-enabled") (.Values.metal3.provider | eq "suse")) }}'

  capv:
    enabled: '{{ .Values.cluster.capi_providers.infra_provider | eq "capv" }}'

  cabpk:  # kubeadm
    enabled: '{{ .Values.cluster.capi_providers.bootstrap_provider | eq "cabpk" }}'

  cabpr:  # RKE2
    enabled: '{{ .Values.cluster.capi_providers.bootstrap_provider | eq "cabpr" }}'
  
  harbor:
    enabled: true

  workload-cluster:
    enabled: '{{ .Values.env_type | eq "ci" }}'

  os-image-server:
    enabled: '{{ (or (tuple . "metal3" | include "unit-enabled") (tuple . "metal3-suse" | include "unit-enabled")) }}'

  kubevirt:
    enabled: false

  kubevirt-test-vms:
    enabled: false

  monitoring:
    helmrelease_spec:
      values:
        global:
          cattle:
            clusterId: local

keycloak:
  keycloak_expire_password_days: 30
