{{- $envAll := set . "Values" (include "interpret-values-gotpl" . | fromJson) -}}
{{- if (tuple $envAll "cluster" | include "is-component-enabled") -}}
apiVersion: v1
kind: ConfigMap
metadata:
  name: cluster-vars
  labels:
{{ include "sylva-units.labels" $envAll | indent 4 }}
data:
  CLUSTER_NAME: {{ .Values.cluster.name }}
  MACHINE_IMAGE: {{ .Values.cluster.image }}
{{ if eq .Values.cluster.capi_providers.infra_provider "capo" }}
  FLAVOR_NAME: {{ .Values.cluster.capo.flavor_name }}
  SSH_KEY_NAME: {{ .Values.cluster.capo.ssh_key_name }}
  CAPO_NETWORK_ID: {{ .Values.cluster.capo.network_id }}
  CLUSTER_EXTERNAL_IP: {{ .Values.cluster.cluster_external_ip }}
{{ end }}
{{ if eq .Values.cluster.capi_providers.infra_provider "capv" }}
  VS_DC_NAME: {{ .Values.cluster.capv.dataCenter }}
  VS_NETWORK: {{ .Values.cluster.capv.network }}
  VS_SERVER: {{ .Values.cluster.capv.server }}
  VS_TLS_THUMBPRINT: {{ .Values.cluster.capv.tlsThumbprint }}
{{ end }}
{{ end }}
