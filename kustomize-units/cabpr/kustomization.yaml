apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - https://github.com/rancher-sandbox/cluster-api-provider-rke2/releases/download/v0.2.2/bootstrap-components.yaml
  - https://github.com/rancher-sandbox/cluster-api-provider-rke2/releases/download/v0.2.2/control-plane-components.yaml


# Temporary fix to workaround https://gitlab.com/sylva-projects/sylva-core/-/issues/832 until an upstream fix is released
# (images are build from this commit: https://github.com/zioc/cluster-api-provider-rke2/commit/53c7d0ad19442e0161aebd3e122f453be534d31a)
images:
- name: ghcr.io/rancher-sandbox/cluster-api-provider-rke2-bootstrap
  newName: registry.gitlab.com/sylva-projects/sylva-elements/container-images/sandbox-registry/cluster-api-provider-rke2-bootstrap-amd64
  newTag: 0.2.2-token
- name: ghcr.io/rancher-sandbox/cluster-api-provider-rke2-controlplane
  newName: registry.gitlab.com/sylva-projects/sylva-elements/container-images/sandbox-registry/cluster-api-provider-rke2-controlplane-amd64
  newTag: 0.2.2-token

# Add labels to enable clusterctl move to retrieve resources correponding to cabpr CRDs
labels:
  - pairs:
      clusterctl.cluster.x-k8s.io: ""
