apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: GitRepository
metadata:
  name: metal3-helm-chart-gitlab-repo
  namespace: default
spec:
  gitImplementation: libgit2
  interval: 10m
  ref:
    branch: main
  timeout: 1m0s
  url: https://gitlab.com/t6306/components/helm-charts/metal3.git
  secretRef:
    name: git-repo-auth-metal3
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: metal3
  namespace: default
spec:
  targetNamespace: metal3-system
  releaseName: metal3
  chart:
    spec:
      chart: egate/metal3
      sourceRef:
        kind: GitRepository
        name: metal3-helm-chart-gitlab-repo
        namespace: default
  interval: 1m0s
  install:
    createNamespace: true
  valuesFrom:
  - kind: Secret
    name: component-metal3-values
    valuesKey: values
  values: {}
